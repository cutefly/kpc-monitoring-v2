[
    {
        "seq": 18,
        "period": 3,
        "title": "[Logging] Infra log shipper",
        "monitor_type": "SERVER",
        "query": "http://192.168.1.145:9600/_node/pipelines?pretty",
        "check_type": "in",
        "check_value": "infra-log-shipper",
        "wait_time": 15,
        "warn_time": 10,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "G1",
        "message_format": "Infra log shipper 오류",
        "interval": 0,
        "latest": 1580719336577
    },
    {
        "seq": 17,
        "period": 3,
        "title": "[Logging] Kibana 모니터링",
        "monitor_type": "SERVER",
        "query": "http://192.168.1.146:5601/api/spaces/space/default",
        "check_type": "in",
        "check_value": "\"id\":\"default\"",
        "wait_time": 15,
        "warn_time": 10,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "G1",
        "message_format": "Elasticsearch Kibana 오류",
        "interval": 0,
        "latest": 1580737218773
    },
    {
        "seq": 16,
        "period": 3,
        "title": "[Logging] Elasticsearch 모니터링",
        "monitor_type": "SERVER",
        "query": "http://192.168.1.146:9200/_nodes/master?filter_path=cluster_name",
        "check_type": "eq",
        "check_value": "{\"cluster_name\":\"elasticsearch\"}",
        "wait_time": 30,
        "warn_time": 10,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "G1",
        "message_format": "Elasticsearch 오류",
        "interval": 0,
        "latest": 1580737251047
    },
    {
        "seq": 15,
        "period": 1,
        "title": "로그아카이브 비정상 증가",
        "monitor_type": "ORACLE",
        "query": "SELECT\r\n  NVL(MAX(val), 0) AS val\r\nFROM\r\n  (\r\n    SELECT\r\n      INST_ID,\r\n      EVENT,\r\n      MAX(DECODE(type, 'CUR',AVG_VAL, 0)) - MAX(DECODE(type, 'CUR',AVG_VAL, 0))\r\n      AS val\r\n    FROM\r\n      (\r\n        SELECT\r\n          'CUR' AS type,\r\n          INST_ID,\r\n          EVENT,\r\n          ROUND(AVG(TOTAL_WAITS)) AS AVG_VAL,\r\n          MAX(create_Dt)\r\n        FROM\r\n          kpc_dba.DB_MONITOR_IO\r\n        WHERE\r\n          create_dt    > TRUNC(sysdate, 'mi')-1/24/6\r\n        AND create_dt <= TRUNC(sysdate, 'mi')\r\n        AND EVENT      = 'Log archive I/O'\r\n        GROUP BY\r\n          INST_ID,\r\n          EVENT\r\n        UNION ALL\r\n        SELECT\r\n          'PRE' AS type,\r\n          INST_ID,\r\n          EVENT,\r\n          ROUND(AVG(TOTAL_WAITS)) AS AVG_VAL,\r\n          MAX(create_Dt)\r\n        FROM\r\n          kpc_dba.DB_MONITOR_IO\r\n        WHERE\r\n          create_dt    > TRUNC(sysdate, 'mi')-1/24/6*2\r\n        AND create_dt <= TRUNC(sysdate, 'mi')-1/24/6\r\n        AND EVENT      = 'Log archive I/O'\r\n        GROUP BY\r\n          INST_ID,\r\n          EVENT\r\n      )\r\n    GROUP BY\r\n      INST_ID,\r\n      EVENT\r\n    HAVING\r\n      MAX(DECODE(type, 'CUR',AVG_VAL, 0)) - MAX(DECODE(type, 'CUR',AVG_VAL, 0))\r\n      >= 2000  )\r\nHAVING\r\n  NVL(MAX(val), 0) >= 2000",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[DB모니터링] Log archive I/O : {VAL}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 14,
        "period": 1,
        "title": "DB부하 세션 증가",
        "monitor_type": "ORACLE",
        "query": "SELECT\r\n  COUNT(1)\r\nFROM\r\n  gv$session\r\nWHERE\r\n  STATUS                 = 'ACTIVE'\r\nAND NVL(TYPE, 'ZZ')     <> 'BACKGROUND'\r\nAND NVL(USERNAME, 'ZZ') <> 'KPC_DBA'",
        "check_type": "le",
        "check_value": "10",
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[DB모니터링] SESSION_CNT : {}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 13,
        "period": 3,
        "title": "DB쿼리 (10분 경과)",
        "monitor_type": "ORACLE",
        "query": "SELECT\r\n  SID,\r\n  USERNAME,\r\n  OSUSER,\r\n  MACHINE,\r\n  TERMINAL,\r\n  PROGRAM,\r\n  LAST_CALL_ET ,\r\n  b.SQL_TEXT\r\nFROM\r\n  gv$session A ,\r\n  gv$sql b\r\nWHERE\r\n  STATUS          = 'ACTIVE'\r\nAND username     IS NOT NULL\r\nAND a.sql_id      = b.sql_id\r\nAND LAST_CALL_ET >= 600",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "30분 초과 쿼리 [{SID}, {USERNAME}, {MACHINE}, {PROGRAM}, {LAST_CALL_ET}초]",
        "interval": 0,
        "latest": 1585910403806
    },
    {
        "seq": 12,
        "period": 3,
        "title": "DB LOCK (10초 이상)",
        "monitor_type": "ORACLE",
        "query": "SELECT DISTINCT\r\n    A.SID AS SID\r\n    , A.USERNAME AS USERNAME\r\n    , A.MACHINE AS MACHINE\r\n    , A.PROGRAM AS PROGRAM\r\n    ,D.NAME AS LOCKED_OBJECT_NAME\r\n    ,C.CTIME AS SECONDS_IN_WAIT\r\nFROM GV$SESSION A\r\n    ,GV$LOCKED_OBJECT B\r\n    ,GV$LOCK C\r\n    ,SYS.OBJ$ D\r\nWHERE A.SID = B.SESSION_ID\r\nAND A.STATUS = 'ACTIVE'\r\nAND A.TYPE <> 'BACKGROUND'\r\nAND A.SID = C.SID\r\nAND C.BLOCK = 1\r\nAND C.TYPE <> 'MR'\r\nAND B.OBJECT_ID = D.OBJ#(+)\r\nAND C.CTIME > 10",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "DB LOCK 발생 [{SID}, {USERNAME}, {MACHINE}, {PROGRAM}, {LOCKED_OBJECT_NAME}, {SECONDS_IN_WAIT}초]",
        "interval": 0,
        "latest": 1582893602673
    },
    {
        "seq": 11,
        "period": 1,
        "title": "MSSQL 테스트",
        "monitor_type": "MSSQL",
        "query": "SELECT count(*)\r\n  FROM HMPOSA_DB.dbo.TTxSAFRejectLog with(nolock)\r\n WHERE regdate >= DATEADD(MINUTE,-10,GETDATE())",
        "check_type": "exist",
        "check_value": "0",
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[MSSQL] Store ID : {storeId}, Store Code : {storeCode}, StoreName : {storeName}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 10,
        "period": 6,
        "title": "POSA 가상점포 재고",
        "monitor_type": "API",
        "query": "http://api-posa.happymoney.co.kr/monitor_mid?type=VstoreCnt&mid=&durationtype=&duration=&value=&option=",
        "check_type": "exist",
        "check_value": "0",
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[POSA 가상점포 재고] 판매처 : {mid}, 가상점포수 : {count}",
        "interval": 0,
        "latest": 1586304002363
    },
    {
        "seq": 9,
        "period": 3,
        "title": "모바일팝 자동발권 잔여카드 수",
        "monitor_type": "ORACLE",
        "query": "SELECT\r\n  COUNT(1) AS cnt\r\nFROM\r\n  KPC_APPROVAL.MOBILE_BARCODE_INVEN\r\nWHERE\r\n  ACTIVE_YN IS NULL",
        "check_type": "gt",
        "check_value": "50000",
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "모바일팝 카드 잔여수량 {CNT}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 8,
        "period": 1,
        "title": "팝카드 거래오차",
        "monitor_type": "ORACLE",
        "query": "SELECT COUNT(1) AS cnt\r\n  FROM KPC_APPROVAL.MOBILE_MEMBERS_DIFF A\r\n WHERE A.CUR_AMT - A.DIFF <> 0",
        "check_type": "eq",
        "check_value": "267",
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "카드잔액 오차발생 ({}건)",
        "interval": 0,
        "latest": 1533631802805
    },
    {
        "seq": 6,
        "period": 2,
        "title": "POSA가상점포",
        "monitor_type": "API",
        "query": "http://api-posa.happymoney.co.kr/monitor_mid?type=VStroe&mid=&durationtype=&duration=&value=&option=",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[POSA 가상점포] 판매처 : {mid}, 가상점포수 : {count}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 5,
        "period": 2,
        "title": "미니스톱거래금액",
        "monitor_type": "API",
        "query": "http://api-posa.happymoney.co.kr/monitor?type=monitor&mid=60300003125&durationtype=m&duration=30&value=500000&option=",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "[미니스톱] 점포코드:{storecode},점포명:{storename},판매건수:{quantity},판매금액:{amount}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 4,
        "period": 2,
        "title": "미니스톱거래건수",
        "monitor_type": "API",
        "query": "http://api-posa.happymoney.co.kr/monitor_qnty?type=monitor_qnty&mid=60300003125&durationtype=m&duration=30&quantity=30&option=",
        "check_type": "exist",
        "check_value": null,
        "wait_time": 0,
        "warn_time": 0,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "G3",
        "message_format": "[미니스톱] 점포코드:{storecode},점포명:{storename},판매건수:{quantity},판매금액:{amount}",
        "interval": 0,
        "latest": 0
    },
    {
        "seq": 3,
        "period": 2,
        "title": "webpos.blackhawk-net.com(Santa Clara)",
        "monitor_type": "SERVER",
        "query": "https://user.posagiftcard.co.kr/API/monitor_bhn.aspx?type=webpos",
        "check_type": "eq",
        "check_value": "{\"ERRMSG\":\"<h1>[GET] method not implemented!</h1>\",\"RETCODE\":0}",
        "wait_time": 30,
        "warn_time": 10,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "webpos(Snata Clara)에서 비정상 응답이 수신되었습니다.",
        "interval": 0,
        "latest": 1586080222008
    },
    {
        "seq": 2,
        "period": 2,
        "title": "blastapp.blackhawk-net.com(FortWorth)",
        "monitor_type": "SERVER",
        "query": "https://user.posagiftcard.co.kr/API/monitor_bhn.aspx?type=blastapp",
        "check_type": "eq",
        "check_value": "{\"ERRMSG\":\"<h1>[GET] method not implemented!</h1>\",\"RETCODE\":0}",
        "wait_time": 30,
        "warn_time": 10,
        "use_flag": "Y",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "blastapp(FortWorth)에서 비정상 응답이 수신되었습니다.",
        "interval": 0,
        "latest": 1586013331182
    },
    {
        "seq": 1,
        "period": 1,
        "title": "pay.happymoney.co.kr",
        "monitor_type": "SERVER",
        "query": "https://pay.happymoney.co.kr/",
        "check_type": "eq",
        "check_value": "pay.happymoney.co.kr",
        "wait_time": 30,
        "warn_time": 10,
        "use_flag": "N",
        "sender": "18993206",
        "receiver": "01043668760",
        "message_format": "해피머니 webpay에서 비정상 응답이 수신되었습니다.",
        "interval": 0,
        "latest": 1534136280738
    }
]